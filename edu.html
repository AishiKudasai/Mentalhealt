<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mind Matters — An Interactive Guide to Mental Health (Single File)</title>
  <meta name="description" content="A single-file, responsive, interactive educational guide about mental health: explanations, when to seek help, how to support yourself and others, myths vs facts, self-check, mood check-in, and wellbeing tools." />
  <style>
    :root {
  /* Dark theme (default) */
  --bg: #0b0c10;
  --surface: #111217;
  --panel: #141822;
  --text: #e9eef7;
  --muted: #b7c3d6;
  --brand: #1e3a8a;   /* Dark indigo */
  --brand-2: #2563eb; /* Strong blue */
  --ok: #22c55e;
  --warn: #f59e0b;
  --danger: #ef4444;
  --card: #0e1117;
  --border: #2a2f3a;
  --shadow: 0 8px 30px rgba(0,0,0,.35);
}

[data-theme="light"] {
  --bg: #f0f9ff;
  --surface: #ffffff;
  --panel: #ffffff;
  --text: #0e1320;
  --muted: #35405a;
  --brand: #60a5fa;   /* Light blue */
  --brand-2: #38bdf8; /* Sky blue accent */
  --card: #ffffff;
  --border: #dbeafe;
  --shadow: 0 6px 24px rgba(2, 6, 23, .08);
}

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Layout */
    header {
      position: sticky; top: 0; z-index: 30;
      backdrop-filter: saturate(160%) blur(10px);
      background: color-mix(in oklab, var(--surface) 70%, transparent);
      border-bottom: 1px solid var(--border);
    }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 0 16px; }
    .row { display: grid; gap: 16px; }
    @media (min-width: 768px) { .row-2 { grid-template-columns: 1fr 1fr; } }
    @media (min-width: 1024px) { .row-3 { grid-template-columns: repeat(3, 1fr); } }

    /* Topbar */
    .topbar { display: flex; align-items: center; justify-content: space-between; padding: 12px 0; }
    .brand { display: flex; gap: 12px; align-items: center; font-weight: 700; letter-spacing: .2px; }
    .logo {
      width: 36px; height: 36px; border-radius: 10px;
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      display: grid; place-items: center; color: white; font-weight: 900;
      box-shadow: var(--shadow);
    }
    .actions { display: flex; gap: 8px; align-items: center; }
    button, .btn { cursor: pointer; border: 0; background: var(--brand); color: #fff; border-radius: 10px; padding: 10px 14px; font-weight: 600; box-shadow: var(--shadow); }
    .btn.secondary { background: transparent; color: var(--text); border: 1px solid var(--border); }

    /* Progress bar */
    .progress { position: fixed; inset: 0 auto auto 0; height: 3px; background: linear-gradient(90deg, var(--brand), var(--brand-2)); width: 0; z-index: 40; }

    /* Hero */
    .hero { padding: 24px 0 8px; }
    .hero h1 { font-size: clamp(1.6rem, 1.2rem + 2vw, 2.4rem); margin: 8px 0 4px; line-height: 1.2; }
    .hero p { color: var(--muted); margin: 0; }
    .note { margin-top: 12px; font-size: .95rem; color: var(--muted); }
    .tag { display: inline-block; font-size: .8rem; color: #fff; background: linear-gradient(135deg, var(--brand), var(--brand-2)); padding: 6px 10px; border-radius: 999px; }

    /* Cards */
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 18px; box-shadow: var(--shadow); }
    .card h2 { margin: 0 0 6px; font-size: clamp(1.2rem, 1.05rem + .8vw, 1.6rem); }
    .card h3 { margin: 12px 0 6px; font-size: 1.05rem; }
    .muted { color: var(--muted); }
    .pill { display:inline-block; padding: 4px 8px; border:1px solid var(--border); border-radius: 999px; font-size: .8rem; color: var(--muted); }

    /* Accordion */
    .acc { border: 1px solid var(--border); border-radius: 14px; overflow: hidden; background: var(--surface); }
    .acc-item + .acc-item { border-top: 1px solid var(--border); }
    .acc-btn { width: 100%; text-align: left; padding: 14px 16px; background: transparent; color: var(--text); font-weight: 700; display: flex; justify-content: space-between; align-items: center; }
    .acc-panel { max-height: 0; overflow: hidden; transition: max-height .35s ease; padding: 0 16px; }
    .acc-item.active .acc-panel { padding: 0 16px 14px; }

    /* Quiz */
    .quiz q { font-style: italic; }
    .quiz .q { border: 1px dashed var(--border); border-radius: 12px; padding: 12px; margin: 8px 0; display: grid; gap: 10px; }
    .quiz label { display: flex; align-items: center; gap: 10px; }
    .quiz .result { margin-top: 10px; padding: 12px; border-radius: 12px; background: color-mix(in oklab, var(--brand-2) 12%, transparent); border: 1px solid var(--border); }
    /* Grounding */
    .grounding-tool {
        font-family: Arial, sans-serif;
        max-width: 3500px;
        margin: 20px;
        padding: 15px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
    }
    
    .step {
        padding: 8px;
        margin: 5px 0;
    }
    
    .step.done {
        text-decoration: line-through;
        opacity: 0.6;
    }

    .btn {
        background: #4CAF50;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
    }
    
    .pill {
        display: inline-block;
        background: #e8f5e9;
        color: #2e7d32;
        padding: 5px 10px;
        border-radius: 16px;
        margin-top: 10px;
    }

    /* Tools */
    .tools { display: grid; gap: 16px; }
    @media (min-width: 768px){ .tools { grid-template-columns: 1fr 1fr; } }
    .tool { border: 1px solid var(--border); border-radius: 14px; padding: 14px; background: var(--surface); }
    .tool h4 { margin: 4px 0 8px; }
    .meter { height: 10px; background: #1f2430; border-radius: 999px; overflow: hidden; border: 1px solid var(--border); }
    .meter > div { height: 100%; width: 0; background: linear-gradient(90deg, var(--brand), var(--brand-2)); transition: width .2s ease; }

    /* Lists */
    ul.check { list-style: none; padding: 0; margin: 0; }
    ul.check li { padding-left: 28px; position: relative; margin: 6px 0; }
    ul.check li::before { content: '✓'; position: absolute; left: 0; top: 0; color: var(--ok); font-weight: 900; }

    /* Footer (disclaimer) */
    footer { margin: 24px 0 40px; color: var(--muted); font-size: .9rem; }

    /* Focus & a11y */
    a, button, input, textarea, select { outline-color: var(--brand); }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce) {
      .acc-panel { transition: none; }
      .meter > div { transition: none; }
    }
  </style>
</head>
<body data-theme="light">
  <div class="progress" id="progress"></div>
  <header>
    <div class="wrap topbar" role="banner">
      <div class="brand" aria-label="Mind Matters">
        <div class="logo" aria-hidden="true">MM</div>
        <div>Mind Matters — Interactive Guide</div>
      </div>
      <div class="actions">
        <button class="btn secondary" id="toggleTheme" aria-pressed="false" aria-label="Toggle theme">🌗 Theme</button>
        <a class="btn secondary" href="https://aishikudasai.github.io/mentalhealth/" >Back</a>
      </div>
    </div>
  </header>

  <main id="start" class="wrap" role="main">
    <!-- HERO / INTRO -->
    <section class="hero card" aria-labelledby="intro-title">
      <span class="tag">Educational • Non‑diagnostic</span>
      <h1 id="intro-title">Mental Health: What it is, when to seek help, and how to care for yourself</h1>
      <p>
        Mental health affects how we think, feel, and act. It influences how we handle stress, relate to others, and make choices. Everyone has mental health — and everyone can strengthen it. This single‑file guide offers clear explanations, practical tools, and interactive check‑ins. It is not a diagnosis and does not replace professional care.
      </p>
      <p class="note">If you are in immediate danger or thinking about harming yourself, contact your local emergency services right away. You deserve support.</p>
    </section>

    <!-- WHAT & DIFFERENCE -->
    <section class="row row-2" aria-label="Foundations">
      <article class="card">
        <h2>What is mental health?</h2>
        <p>
          Mental health is your overall emotional, psychological, and social well‑being. Healthy mental functioning looks like: being able to enjoy life, feel and express a range of emotions, cope with everyday stress, maintain relationships, and make decisions aligned with your values.
        </p>
        <h3>Factors that shape mental health</h3>
        <ul class="check">
          <li>Biology (e.g., genetics, brain chemistry, hormones)</li>
          <li>Life experiences (e.g., stress, trauma, lifestyle, sleep)</li>
          <li>Environment (e.g., safety, community, culture, access to care)</li>
          <li>Protective factors (e.g., social support, purpose, coping skills)</li>
        </ul>
      </article>

      <article class="card">
        <h2>Mental health vs. mental illness</h2>
        <p>
          <strong>Mental health</strong> is something we all have and can build. <strong>Mental illness</strong> refers to conditions that significantly affect thoughts, feelings, or behavior (for example, depression, anxiety disorders, bipolar disorder, or eating disorders). A person can have a mental illness and still experience moments of well‑being with support and treatment.
        </p>
        <div class="acc" aria-label="Examples">
          <div class="acc-item">
            <button class="acc-btn" aria-expanded="false">Examples of mental health skills <span aria-hidden="true">＋</span></button>
            <div class="acc-panel" role="region">
              <ul class="check">
                <li>Recognizing emotions and naming needs</li>
                <li>Healthy coping (rest, movement, problem‑solving, connection)</li>
                <li>Asking for and accepting help</li>
                <li>Setting boundaries and recovering after stress</li>
              </ul>
            </div>
          </div>
          <div class="acc-item">
            <button class="acc-btn" aria-expanded="false">Examples of mental illnesses <span aria-hidden="true">＋</span></button>
            <div class="acc-panel" role="region">
              <ul class="check">
                <li>Depressive disorders</li>
                <li>Anxiety disorders and panic disorder</li>
                <li>Bipolar and related disorders</li>
                <li>Eating disorders</li>
                <li>Schizophrenia spectrum disorders</li>
                <li>Substance use disorders</li>
              </ul>
              <p class="muted">Diagnosis and treatment should be guided by qualified professionals.</p>
            </div>
          </div>
        </div>
      </article>
    </section>

    <!-- SIGNS & SYMPTOMS -->
    <section class="card" aria-labelledby="signs-title">
      <h2 id="signs-title">Signs & symptoms</h2>
      <div class="row row-3">
        <article class="tool">
          <h3>Emotional symptoms</h3>
          <p>Feeling sad or down for extended periods, excessive fears or worries, extreme feelings of guilt or worthlessness, sudden mood swings or irritability, withdrawal from friends and activities, loss of interest in hobbies, significant tiredness, and low energy.</p>
        </article>
        <article class="tool">
          <h3>Physical symptoms</h3>
          <p>Unexplained aches and pains, significant changes in eating habits, changes in sex drive, difficulty sleeping or sleeping too much, frequent headaches or stomach issues, loss of energy, detachment from reality, paranoia, or hallucinations.</p>
        </article>
        <article class="tool">
          <h3>Behavioral symptoms</h3>
          <p>Withdrawal from friends and activities, reduced ability to concentrate, noticeable decline in performance, misuse of alcohol or drugs, major changes in eating or sleeping patterns, excessive anger or irritability, violent behavior, difficulty coping with daily responsibilities.</p>
        </article>
      </div>
      <p class="note">Experiencing one or more of these does not automatically mean you have a mental illness. Consider patterns over time and impact on daily life.</p>
    </section>

    <!-- WHEN TO SEEK HELP -->
    <section class="row row-2" aria-label="When to seek help">
      <article class="card">
        <h2>When to seek help</h2>
        <ul class="check">
          <li>Symptoms persist for weeks or keep returning</li>
          <li>Your daily life, school, or work is significantly affected</li>
          <li>You're using alcohol or drugs to cope</li>
          <li>You notice drastic changes in sleep, appetite, or energy</li>
          <li>You have thoughts of harming yourself or others — seek urgent support</li>
        </ul>
        <p class="muted">A first step can be talking with a primary care doctor, counselor, or helpline in your area.</p>
      </article>
      <article class="card">
        <h2>How treatment helps</h2>
        <p>Treatment plans are personalized and may include therapy, skills training, lifestyle supports (sleep, movement, nutrition), peer support, and when appropriate, medication. Many people improve with the right mix of support.</p>
        <div class="acc" aria-label="Care options">
          <div class="acc-item">
            <button class="acc-btn" aria-expanded="false">Types of therapy <span aria-hidden="true">＋</span></button>
            <div class="acc-panel" role="region">
              <ul class="check">
                <li>Cognitive Behavioral Therapy (CBT)</li>
                <li>Dialectical Behavior Therapy (DBT)</li>
                <li>Trauma‑informed therapies (e.g., EMDR)</li>
                <li>Family, couples, or group therapy</li>
              </ul>
            </div>
          </div>
          <div class="acc-item">
            <button class="acc-btn" aria-expanded="false">Medication basics <span aria-hidden="true">＋</span></button>
            <div class="acc-panel" role="region">
              <p class="muted">Medication can be helpful for some conditions. Decisions should be made with a licensed clinician who explains benefits, risks, and alternatives.</p>
            </div>
          </div>
        </div>
      </article>
    </section>

    <!-- HOW TO SUPPORT SELF & OTHERS -->
    <section class="row row-2" aria-label="Support">
      <article class="card">
        <h2>How to support yourself</h2>
        <ul class="check">
          <li>Keep a steady sleep schedule and create a wind‑down routine</li>
          <li>Move your body most days — even gentle walks help</li>
          <li>Eat regular, balanced meals; stay hydrated</li>
          <li>Practice calming skills (breathing, grounding, journaling)</li>
          <li>Schedule pleasant activities and connection time</li>
          <li>Limit doom‑scrolling; curate what you consume</li>
        </ul>
      </article>
      <article class="card">
        <h2>How to support a friend</h2>
        <ul class="check">
          <li>Ask open questions and listen without jumping to fix</li>
          <li>Reflect back what you hear ("It sounds like…")</li>
          <li>Offer practical help (a ride, company at an appointment)</li>
          <li>Respect boundaries and privacy</li>
          <li>Encourage professional help; share options if they want</li>
          <li>Call emergency services if there is immediate danger</li>
        </ul>
      </article>
    </section>

    <!-- MYTHS VS FACTS -->
    <section class="card" aria-labelledby="myths-title">
      <h2 id="myths-title">Myths vs facts</h2>
      <div class="row row-3">
        <details class="tool"><summary><strong>Myth:</strong> “Asking for help is a sign of weakness.”</summary><p><strong>Fact:</strong> Reaching out takes courage and is a skill. Early support often leads to better outcomes.</p></details>
        <details class="tool"><summary><strong>Myth:</strong> “You can always tell when someone is struggling.”</summary><p><strong>Fact:</strong> Many people mask distress. Compassionate check‑ins matter.</p></details>
        <details class="tool"><summary><strong>Myth:</strong> “People with mental illness can’t recover.”</summary><p><strong>Fact:</strong> Recovery is common and looks different for everyone. Skills, support, and treatment help.</p></details>
      </div>
    </section>

    <!-- SELF‑CHECK (NON‑DIAGNOSTIC) -->
    <section class="card quiz" aria-labelledby="check-title">
      <h2 id="check-title">Gentle self‑check (not a diagnosis)</h2>
      <p class="muted">Over the last two weeks, how often have the following been true? (0 = not at all, 3 = nearly every day)</p>
      <div class="q">
        <label><span>1) Little interest or pleasure in doing things</span>
          <select data-score>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </label>
        <label><span>2) Feeling down, depressed, or hopeless</span>
          <select data-score>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </label>
        <label><span>3) Feeling nervous, anxious, or on edge</span>
          <select data-score>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </label>
        <label><span>4) Trouble sleeping (or sleeping too much)</span>
          <select data-score>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </label>
        <button class="btn" id="calcScore">See gentle guidance</button>
        <div id="scoreOut" class="result" role="status" aria-live="polite"></div>
      </div>
      <p class="note">If your score is high or you’re concerned, consider talking to a professional or someone you trust. If you have thoughts of self‑harm, seek urgent help now.</p>
    </section>

    <!-- MOOD CHECK‑IN -->
    <section class="card" aria-labelledby="mood-title">
      <h2 id="mood-title">Quick mood check‑in</h2>
      <div class="row row-2">
        <div class="tool">
          <label for="moodRange"><strong>How are you feeling right now?</strong> <span class="pill" id="moodLabel">Neutral (3/5)</span></label>
          <input id="moodRange" type="range" min="1" max="5" value="3" step="1" style="width:100%" aria-describedby="moodDesc" />
          <div id="moodDesc" class="muted">1 = very low • 5 = very good</div>
          <label for="moodNote" class="sr-only">Optional note</label>
          <textarea id="moodNote" rows="3" placeholder="Optional note (what’s affecting your mood?)" style="width:100%; margin-top:8px"></textarea>
          <div style="display:flex; gap:8px; margin-top:8px">
            <button class="btn" id="saveMood">Save entry</button>
            <button class="btn secondary" id="viewMood">View last 7</button>
          </div>
        </div>
        <div class="tool" id="moodHistory" hidden>
          <h4>Last entries</h4>
          <div id="moodList" class="muted"></div>
        </div>
      </div>
    </section>

    <!-- WELLBEING TOOLS -->
    <section class="card">
      <h2>Calming & Grounding Tools</h2>
      <div>
        <h3>Box breathing (4‑4‑4‑4)</h3>
        <div class="meter"><div id="breathBar"></div></div>
        <p id="breathCue">Ready</p>
        <button class="btn" id="startBreath">Start 1 min</button>
        <button class="btn secondary" id="stopBreath">Stop</button>
      </div>
      <hr>
      <div class="grounding-tool">
    <h3>5‑4‑3‑2‑1 grounding</h3>
    <p>Noticing the present using senses</p>
    <div id="groundingSteps">
        <div class="step" data-step="5">👀 <strong>5</strong> things you can see</div>
        <div class="step" data-step="4">✋ <strong>4</strong> things you can feel</div>
        <div class="step" data-step="3">👂 <strong>3</strong> things you can hear</div>
        <div class="step" data-step="2">👃 <strong>2</strong> things you can smell</div>
        <div class="step" data-step="1">👅 <strong>1</strong> thing you can taste</div>
    </div>
    <button class="btn" id="markNext">Mark next complete</button>
    <button class="btn" id="resetGrounding">Reset</button>
    <div id="groundingDone" class="pill" hidden>Completed ✓</div>
</div>
    </section>

    <!-- FAQ -->
    <section class="card" aria-labelledby="faq-title">
      <h2 id="faq-title">FAQ</h2>
      <div class="acc">
        <div class="acc-item">
          <button class="acc-btn" aria-expanded="false">Is this a diagnosis? <span aria-hidden="true">＋</span></button>
          <div class="acc-panel" role="region"><p>No. This guide is educational. Only a qualified professional can diagnose and recommend treatment.</p></div>
        </div>
        <div class="acc-item">
          <button class="acc-btn" aria-expanded="false">What if I’m worried about someone? <span aria-hidden="true">＋</span></button>
          <div class="acc-panel" role="region"><p>Share concerns kindly, listen without judgment, and offer to help them find support. If someone is in immediate danger, contact local emergency services.</p></div>
        </div>
        <div class="acc-item">
          <button class="acc-btn" aria-expanded="false">Can lifestyle changes help? <span aria-hidden="true">＋</span></button>
          <div class="acc-panel" role="region"><p>They often support recovery: sleep, movement, balanced meals, routine, connection, and time outdoors. These complement — not replace — professional care.</p></div>
        </div>
      </div>
    </section>

    <footer>
      <p><strong>Disclaimer:</strong> This single‑file guide is informational only and not a substitute for professional diagnosis, treatment, or emergency care.</p>
    </footer>
  </main>

  <script>
    // Theme toggle with persistence
    const themeBtn = document.getElementById('toggleTheme');
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) document.body.setAttribute('data-theme', savedTheme);
    themeBtn?.addEventListener('click', () => {
      const now = document.body.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      document.body.setAttribute('data-theme', now);
      localStorage.setItem('theme', now);
      themeBtn.setAttribute('aria-pressed', now === 'dark');
    });

    // Reading progress
    const prog = document.getElementById('progress');
    const onScroll = () => {
      const sc = document.documentElement.scrollTop;
      const h = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const w = Math.min(100, Math.max(0, (sc / h) * 100));
      prog.style.width = w + '%';
    };
    document.addEventListener('scroll', onScroll, { passive: true });
    onScroll();

    // Accordion
    document.querySelectorAll('.acc').forEach(acc => {
      acc.querySelectorAll('.acc-item').forEach(item => {
        const btn = item.querySelector('.acc-btn');
        const panel = item.querySelector('.acc-panel');
        btn.addEventListener('click', () => {
          const open = item.classList.toggle('active');
          btn.setAttribute('aria-expanded', open ? 'true' : 'false');
          panel.style.maxHeight = open ? panel.scrollHeight + 'px' : 0;
          const sym = btn.querySelector('span');
          if (sym) sym.textContent = open ? '−' : '＋';
        });
      });
    });

    // Self-check scoring (simple, non-diagnostic)
    const calcBtn = document.getElementById('calcScore');
    const out = document.getElementById('scoreOut');
    calcBtn?.addEventListener('click', () => {
      const scores = [...document.querySelectorAll('[data-score]')].map(s => +s.value);
      const sum = scores.reduce((a,b)=>a+b,0);
      let msg = '';
      if (sum <= 2) msg = 'Your responses suggest things are mostly manageable right now. Keep using helpful routines and supports.';
      else if (sum <= 5) msg = 'You may be carrying some stress. Consider small adjustments (sleep, movement, connection) and check in with someone you trust.';
      else msg = 'It might help to talk with a professional about what you’re noticing. If you feel unsafe or have thoughts of self‑harm, seek urgent help now.';
      out.textContent = `Score: ${sum} — ${msg}`;
    });

    // Mood check-in
    const moodRange = document.getElementById('moodRange');
    const moodLabel = document.getElementById('moodLabel');
    const moodNote = document.getElementById('moodNote');
    const saveMood = document.getElementById('saveMood');
    const viewMood = document.getElementById('viewMood');
    const moodHistory = document.getElementById('moodHistory');
    const moodList = document.getElementById('moodList');

    const moodWords = {1:'Very low',2:'Low',3:'Neutral',4:'Good',5:'Very good'};

    const updateMoodLabel = () => {
      const val = +moodRange.value; moodLabel.textContent = `${moodWords[val]} (${val}/5)`;
    };
    moodRange?.addEventListener('input', updateMoodLabel); updateMoodLabel();

    function getEntries(){ try { return JSON.parse(localStorage.getItem('moodEntries')||'[]'); } catch { return []; } }
    function setEntries(arr){ localStorage.setItem('moodEntries', JSON.stringify(arr)); }

    saveMood?.addEventListener('click', () => {
      const entry = { t: new Date().toISOString(), v: +moodRange.value, note: moodNote.value.trim() };
      const entries = getEntries(); entries.push(entry); setEntries(entries);
      moodNote.value='';
      alert('Mood saved. Thank you for checking in.');
    });

    viewMood?.addEventListener('click', () => {
      const entries = getEntries().slice(-7).reverse();
      if (!entries.length){ moodList.textContent = 'No entries yet.'; moodHistory.hidden = false; return; }
      moodList.innerHTML = entries.map(e => {
        const d = new Date(e.t); const label = `${d.toLocaleDateString()} ${d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}`;
        const note = e.note ? `<div class="muted">✎ ${e.note}</div>` : '';
        return `<div style="padding:8px 0;border-bottom:1px solid var(--border)"><strong>${label}</strong> — ${moodWords[e.v]} (${e.v}/5) ${note}</div>`;
      }).join('');
      moodHistory.hidden = false;
    });

     // Box Breathing (fixing timing with proper stop)
    let breathIntervals = [];
    let totalTime = 60; // total duration in seconds
    let remaining = totalTime;
    const breathBar = document.getElementById('breathBar');
    const breathCue = document.getElementById('breathCue');

    function clearBreathing() {
      breathIntervals.forEach(id => clearInterval(id));
      breathIntervals = [];
    }

    function runBreathing() {
      const phases = ["Inhale", "Hold", "Exhale", "Hold"];
      let step = 0;
      let phaseTime = 4; // 4 seconds per phase

      function nextPhase() {
        if (remaining <= 0) { stopBreathing(); return; }
        const phase = phases[step % phases.length];
        let seconds = phaseTime;

        const interval = setInterval(() => {
          breathCue.textContent = `${phase}… (${remaining}s left)`;
          if (phase === "Inhale") breathBar.style.width = ((phaseTime - seconds + 1) / phaseTime) * 100 + "%";
          if (phase === "Exhale") breathBar.style.width = ((seconds - 1) / phaseTime) * 100 + "%";

          seconds--;
          remaining--;
          if (seconds < 0) {
            clearInterval(interval);
            breathIntervals = breathIntervals.filter(id => id !== interval);
            step++;
            nextPhase();
          }
        }, 1000);
        breathIntervals.push(interval);
      }
      nextPhase();
    }

    function startBreathing() {
      stopBreathing();
      remaining = totalTime;
      runBreathing();
    }

    function stopBreathing() {
      clearBreathing();
      breathCue.textContent = "Ready";
      breathBar.style.width = "0%";
      remaining = totalTime;
    }

    document.getElementById('startBreath').addEventListener('click', startBreathing);
    document.getElementById('stopBreath').addEventListener('click', stopBreathing);

     document.addEventListener('DOMContentLoaded', function() {
        const steps = document.querySelectorAll('#groundingSteps .step');
        let currentStep = 0;
        document.getElementById('markNext').addEventListener('click', function() {
            if (currentStep < steps.length) {
                steps[currentStep].classList.add('done');
                currentStep++;
                
                if (currentStep === steps.length) {
                    document.getElementById('groundingDone').hidden = false;
                }
            }
        });
        document.getElementById('resetGrounding').addEventListener('click', function() {
            steps.forEach(function(step) {
                step.classList.remove('done');
            });
            currentStep = 0;
            document.getElementById('groundingDone').hidden = true;
        });
    });
  </script>
</body>
</html>
